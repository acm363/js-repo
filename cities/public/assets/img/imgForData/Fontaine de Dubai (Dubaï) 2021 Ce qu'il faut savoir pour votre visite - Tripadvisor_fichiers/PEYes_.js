(this.$WP=this.$WP||[]).push(["PEYes_",(e,t)=>{"use strict";var r,n,a,s,l,i,u,o,c,d,g,v,m,f,p,h,T,R,O,E,A,S,y,b,I,k,C,P,_,N,L,j,D,w,q,x,F,M,$,G,U={APS_SSR_ERROR:"fusion-apsError-count",APS_SSR_PARTIAL:"fusion-apsPartial-count",GRAPHQL_SSR_ERROR:"fusion-graphQLError-count"};function H(e,t){r("global",U[e],t)}var B="navbar",Q="category",V="allAttractions",K="attractionType",Y="type",z="attraction",W="attraction_product",J="hotel",X="restaurant",Z="AttractionsFusion",ee="Attraction_ReviewFusion",te="AttractionProductsFusion",re="AttractionProductReviewFusion",ne="HotelsFusion",ae="HotelsListFusion",se="Hotel_ReviewFusion",le="RestaurantsFusion",ie="Restaurant_ReviewFusion",ue="REMOVE",oe=(e,t)=>{var{contentType:r="none",geoId:n="none"}=t||{};return`${String(n)}~${String(r)}~${e}`},ce=e=>oe("filters",e),de=(e,t)=>{var{filters:r=[]}=e||{},s=ce(e),l=((e,t)=>{var r=(e=>{if(!e)return new Set;var t=a(e),r=null==t?void 0:t.pageParameters.flatMap((e=>"string"!=typeof e.type&&"Filters"===e.type.name?e.type.filters:e)).filter((({category:e})=>"CANONICAL"===e)).map((e=>e.apiName));return new Set(r||[])})(t);return(null==e?void 0:e.filter((e=>e&&e.id&&!r.has(e.id))))||[]})(r,t);l.length>0?n.set(s,l):n.remove(s)},ge=e=>e&&e.id?{id:e.id,value:(e.value||[]).filter(Boolean)}:null,ve=(e,t)=>{return[...new Map((r=[...e,...t],r.filter(Boolean).map(ge).filter(Boolean)).map((e=>[e.id,e]))).values()];var r},me=(e,t)=>{var r=new Map;return e.forEach((e=>r.set(e.id,e))),t.forEach((e=>{var t=r.has(e.id)?r.get(e.id):{id:e.id,value:e.value},n=((e,t,r,n)=>{var a=new Set(t||e||[]);return null==r||r.forEach((e=>a.add(e))),null==n||n.forEach((e=>a.delete(e))),Array.from(a.keys())})(null==t?void 0:t.value,e.value,e.selected,e.deselected);r.set(e.id,{id:e.id,value:n})})),Array.from(r.entries()).map((([,e])=>e))},fe=(e,t)=>{var r=[...e,...t],n=new Map;return r.forEach((e=>{var t,r,a,s=n.get(e.id);n.set(e.id,null!=s?(r=e,{id:(t=s).id,selected:[...new Set([...t.selected||[],...r.selected||[]])],deselected:[...new Set([...t.deselected||[],...r.deselected||[]])],value:((null==(a=r.value)?void 0:a.length)||0)>0?r.value:t.value}):e)})),Array.from(n.entries()).map((([,e])=>e))},pe=e=>{var t=e.getFullYear(),r=e.getMonth()+1;r=r<10?`0${r}`:r;var n=e.getDate();return`${t}-${r}-${n=n<10?`0${n}`:n}`},he=(e,t)=>{var r=new Date(e);return t&&(r.setHours(t.hour),r.setMinutes(t.minute)),pe(r)},Te=e=>{var t;if(null!=(null==e?void 0:e.find((e=>"navbar"===(null==e?void 0:e.id)))))return[];var r=null==e?void 0:e.find((e=>"category"===(null==e?void 0:e.id))),n=null==r||null==(t=r.value)?void 0:t[0];return n&&n.length>2?[{id:"navbar",value:[`APLIST:${n}-true`]}]:[]};function Re(e,t,r=!1){return!!t&&(!r||e!==z&&e!==W?t.filter(Boolean).length>0:t.filter(Boolean).filter((e=>e.id&&!L.has(e.id))).length>0)}var Oe=e=>{var[{data:t,fetching:r,error:n}]=e;if(!1===r){if(n&&"CombinedError"===n.name)return 503;if(null==t?void 0:t.Result){var{status:a}=t.Result[0];if(!1===a.success||!0===a.partial)return 503}}return 200},Ee=e=>{var[{data:t,fetching:r}]=e;if(!1===r&&(null==t?void 0:t.Result)){var{sections:n}=t.Result[0];if(!(null==n?void 0:n.length))return 503}return Oe(e)},Ae=({children:e,href:t="#",theme:r="none",target:n="newTabDesktop",trackingDetails:a,accessibilityString:l,onClick:i})=>{var u=c(n),{trackClick:g}=d(a),v=s.useCallback((()=>(i&&i(),g(),!0)),[i,g]);return s.createElement(o,{target:u,theme:r,onClick:v,href:t,"aria-label":l},e)},Se={S:(e,t)=>{Object.assign(e.dataset,{strikethroughStart:t("fusion_strikethrough_start"),strikethroughEnd:t("fusion_strikethrough_end")})},SPAN:(e,t)=>{if(e.classList.contains("strikethrough")){var r=e.innerHTML,n=e.ownerDocument.createElement("s");n.innerHTML=r,Se.S(n,t),e.innerHTML="",e.appendChild(n)}}},ye=({tagName:e="span",content:t})=>{var{localize:r}=m(),n=s.useRef();return s.useEffect((()=>{var e=n.current;if(e){var t=new Set;if([...e.querySelectorAll("*")].map((e=>{[...e.getAttributeNames()].forEach((t=>{("class"!==t||"class"===t&&"strikethrough"!==e.getAttribute(t))&&e.removeAttribute(t)}));var t=e.tagName.toUpperCase();return t in Se&&Se[t](e,r),t})).forEach((e=>{j.has(e)||t.add(e)})),t.size>0){var a=[...t].join(","),s=`HtmlString should not contain: ${a}`;console.error(s),e.dataset.apsUnexpected=a}}}),[t,r]),s.createElement(e,{className:"_2tsgCuqy",dangerouslySetInnerHTML:{__html:t},ref:n})},be=e=>{var t,r,n=(null==e||null==(t=e.routeParameters)?void 0:t.pagee)&&parseInt(null==e||null==(r=e.routeParameters)?void 0:r.pagee,10);return n&&!Number.isNaN(n)?n:0};function Ie(){var[{page:e,params:t}]=s.useContext(p),r=(null==t?void 0:t.contentType)||"";switch(r){case J:case z:case W:case X:return r;default:return(e=>(/(hotel|lastminute|showuserreviews|smartdeals)/i.test(e)?J:/^(attraction_product|attractionproductreview)/i.test(e)&&W)||/^attraction/i.test(e)&&z||/^restaurant/i.test(e)&&X||null)(e)}}var ke=e=>{var{attractions:t}=e,r={},n=(e=>{var t=[];return null!=e.adults&&e.adults>0&&t.push({ageBand:"ADULT",count:e.adults}),t.length||t.push({ageBand:"ADULT",count:2}),t})(t);return n.length>0&&(r={pax:n}),t.fromDate&&(r=Object.assign({},r,{startDate:pe(t.fromDate)})),t.toDate&&(r=Object.assign({},r,{endDate:pe(t.toDate)})),t.fromDate&&t.toDate&&(r=Object.assign({},r,{setByUser:!0})),Object.keys(r).length>0?Object.assign({},r):null},Ce=e=>{var{hotels:t}=e;return{checkIn:(null==t?void 0:t.checkInDate)&&!t.defaultDates?pe(t.checkInDate):null,checkOut:(null==t?void 0:t.checkOutDate)&&!t.defaultDates?pe(t.checkOutDate):null,rooms:(()=>{var e=[];if(t){var{rooms:r,adults:n,children:a,childAgesPerRoom:s}=t;a>0&&(!s||r<s.length)&&console.error("Malformed hotel travel info, rooms vs. childAgesPerRoom",r,s.length,a);for(var l=0,i=0,u=0;u<n;u++)e[l]?e[l]=Object.assign({},e[l],{adults:e[l].adults+1}):(e[l]={adults:1},s[l]&&Array.isArray(s[l])&&s[l].length&&(e[l]=Object.assign({},e[l],{childrenAges:s[l]}),i+=s[l].length)),++l>=r&&(l=0);i!==(a||0)&&console.error(`Hotel info mismatch: totalChildren for ${r} rooms: ${i} != ${a}`,JSON.stringify(s))}return 0===e.length?null:e})(),setByUser:null!==t&&!t.defaultDates||null}},Pe=e=>{var{restaurants:t}=e;return t.date?{partySize:t.guests||1,reservationTime:t.date&&he(t.date,t.time)}:null},_e=({clearDatesOnGeoChange:e,children:t})=>s.createElement(w.Provider,{value:{clearDatesOnGeoChange:e}},t);function Ne(){var[{page:e,path:t}]=s.useContext(p);return((e,t)=>/\/Hotel_Review-s1-+/i.test(t)?"HotelHighlight":e)(e,t)}function Le(){var e=Ne(),[,{uid:t}]=s.useContext(p);return s.useMemo((()=>({screenName:e,pageviewUid:t})),[e,t])}var je=(e,t)=>{var r=Array.from(Array(t),(()=>[]));if(e.length>0)for(var n=[...e],a=Math.floor(n.length/t),s=n.length-a*t,l=0;l<r.length;l++){var i=a+(l<s?1:0);i>0&&(r[l]=n.slice(0,i),n=n.slice(i))}return r},De=({rooms:e,adults:t,childrenAges:r})=>{var n=Math.floor(t/e),a=t%e,s=je(r,e);return Array.from(Array(e),((e,t)=>s[t].length?{adults:n+(t<a?1:0),childrenAges:s[t]}:{adults:n+(t<a?1:0)}))},we=(e,t,r)=>{var{route:n,pageName:a}=e;if(n&&b(a)){var s=Object.assign({},n.params,{},t);if(n.page!==a||!S(n.params,s))return Object.assign({},n,{page:r||a,params:s})}return null},qe=(e,t,r,n=!1)=>{var a,s=0!==t?String(t):null,l=((e,t)=>{var{listRequest:r,pageName:n}=e,{routeParameters:a=null}=r,s=null==a?void 0:a.filters;if(n===Z){var l,i=null==a||null==(l=a.filters)?void 0:l.filter((e=>(null==e?void 0:e.id)!==V));s=(null==i?void 0:i.length)||null!=t?i:[N]}return s})(e,s),i=null==(a=e.listRequest.routeParameters)?void 0:a.sort,u=we(e,{pagee:s,sort:i,filters:l});return u?(r(u),Object.assign({},e,{navigating:!0})):(e.route&&n&&r(e.route,"PARAM_UPDATE",!0),e)},xe=(e,t,r=!1)=>{var n=Object.assign({},e,{detailRequest:Object.assign({},e.detailRequest,{routeParameters:Object.assign({},e.detailRequest.routeParameters,{pagee:null})})}),a=we(e,{offset:null});return a?(t(a,"IN_PLACE"),Object.assign({},n,{navigating:!0})):(e.route&&r&&t(e.route,"PARAM_UPDATE",!0),n)},Fe=(e,t)=>{var r,n=null==(r=e.commerce)?void 0:r.hotelCommerce,a=Object.assign({},n,{checkIn:null==t.dates?(null==n?void 0:n.checkIn)||null:pe(t.dates.checkIn),checkOut:null==t.dates?(null==n?void 0:n.checkOut)||null:pe(t.dates.checkOut),rooms:null==t.guests?(null==n?void 0:n.rooms)||null:De(t.guests),setByUser:!0});return{newState:Object.assign({},e,{commerce:Object.assign({},e.commerce,{hotelCommerce:a})}),hasStateChanged:!S(n,a)}},Me=(e,t)=>{var r;return Object.assign({},e,{commerce:Object.assign({},e.commerce,{attractionCommerce:Object.assign({},null==(r=e.commerce)?void 0:r.attractionCommerce,{startDate:null!=t.dates?pe(t.dates.startDate):null,endDate:null!=t.dates?pe(t.dates.endDate):null,setByUser:null!=t.dates})})})},$e=(e,t,r)=>{var n,a,s,l,i,u,o,c,d,g,v,m,f,p,h,T=(e,t,n)=>r(e,t||(b(e.page)?"PARAM_UPDATE":"PAGE_VIEW"),n);switch(t.type){case"reinitialize":var R,O,E=null==(R=e.detailRequest)?void 0:R.routeParameters,A=null==(O=t.newState.detailRequest)?void 0:O.routeParameters;return"detail"===e.screenType&&(null==E?void 0:E.contentId)===(null==A?void 0:A.contentId)&&(null==E?void 0:E.contentType)===(null==A?void 0:A.contentType)?(c=e,d=t.newState,p=(f=null==(g=c.commerce)||null==(v=g.attractionCommerce)?void 0:v.pax)&&(null==(m=d.commerce)?void 0:m.attractionCommerce)?Object.assign({},d.commerce,{attractionCommerce:Object.assign({},d.commerce.attractionCommerce,{pax:f})}):d.commerce,h={routeParameters:Object.assign({},c.detailRequest.routeParameters),updateToken:c.detailRequest.updateToken,clientState:c.detailRequest.clientState},Object.assign({},d,{commerce:p,detailRequest:Object.assign({},d.detailRequest,{},h)})):t.newState;case"updateRouteParameters":return Object.assign({},e,{listRequest:Object.assign({},e.listRequest,{routeParameters:Object.assign({},e.listRequest.routeParameters,{},t.routeParameters)})});case"setUpdateToken":return Object.assign({},e,{detailRequest:Object.assign({},e.detailRequest,{updateToken:t.updateToken}),listRequest:Object.assign({},e.listRequest,{updateToken:t.updateToken}),updateToken:t.updateToken});case"setFilter":return((e,t,r)=>{var{listRequest:n,pageName:a}=e,{routeParameters:s=null}=n,l=ve((null==s?void 0:s.filters)||[],t);l=l.filter((({value:e})=>null!=e&&0!==e.length&&e[0]!==ue));var i=a;if(a===Z||a===te){var u,o,c,d,g,v,m,f,p=t.find((e=>e.id===B)),h=t.find((e=>e.id===Q)),T=t.find((e=>e.id===Y)),R=null==h||null==(u=h.value)?void 0:u[0],O=null==s||null==(o=s.filters)||null==(c=o.find((e=>(null==e?void 0:e.id)===Q)))||null==(d=c.value)?void 0:d[0],E=null==T||null==(g=T.value)?void 0:g[0],A=null==s||null==(v=s.filters)||null==(m=v.find((e=>(null==e?void 0:e.id)===Y)))||null==(f=m.value)?void 0:f[0];if(p){var S,y=(null==(S=p.value)?void 0:S[0])||"",[,b,I,k]=y.match(/^(ATTRACTIONOVERVIEW|APLIST):(\d*)-(true|false)/)||[];"false"===k&&("ATTRACTIONOVERVIEW"===b?(i=Z,l=I&&""!==I?[{id:Q,value:[I]}]:[N]):"APLIST"===b&&(i=Z,"11867"===I?l=I&&""!==I?[{id:Q,value:["63"]}]:[]:"12024"===I&&(l=I&&""!==I?[{id:Q,value:["41"]}]:[])))}else h&&R!==O&&(l=[h]);l=O&&"61"===O&&E!==A?l.filter((e=>(null==e?void 0:e.id)!==B&&((null==e?void 0:e.id)===Q||(null==e?void 0:e.id)===Y))):l.filter((e=>(null==e?void 0:e.id)!==B))}var C=Object.assign({},n.routeParameters,{filters:[...l,...Te(l)],pagee:void 0}),P=Object.assign({},e,{listRequest:Object.assign({},e.listRequest,{routeParameters:C})});de(C,i);var _=we(e,C,i===ae?ne:null);return _?(r(_),Object.assign({},P,{navigating:!0})):P})(e,t.filters,T);case"resetPageNumber":return((e,t)=>{var r,n=Object.assign({},null==e||null==(r=e.listRequest)?void 0:r.routeParameters,{pagee:void 0}),a=Object.assign({},e,{listRequest:Object.assign({},e.listRequest,{routeParameters:n})}),s=we(e,n);return s&&t(s),a})(e,T);case"updateReviewFilters":return xe(Object.assign({},e,{detailRequest:Object.assign({},e.detailRequest,{updateToken:null,clientState:{userInput:(u=(null==(n=e.detailRequest.clientState)?void 0:n.userInput)||[],o=t.filters,[...o,...u].filter(((e,t,r)=>t===r.findIndex((t=>(null==t?void 0:t.inputKey)===(null==e?void 0:e.inputKey))))))}})}),T);case"removeReviewFilters":return xe(Object.assign({},e,{detailRequest:Object.assign({},e.detailRequest,{clientState:{userInput:(l=t.filtersToRemove,i=(null==(a=e.detailRequest.clientState)?void 0:a.userInput)||[],l.findIndex((e=>e&&"*"===e))>=0?[]:i.filter((e=>!l.includes(null==e?void 0:e.inputKey))))}})}),T);case"resetReviewFilters":return xe(Object.assign({},e,{detailRequest:Object.assign({},e.detailRequest,{clientState:{userInput:[]}})}),T);case"paginate":return qe(e,t.offset,T);case"setSort":return((e,t,r)=>{var n,a=Object.assign({},null==e||null==(n=e.listRequest)?void 0:n.routeParameters,{sort:t,pagee:void 0}),s=Object.assign({},e,{listRequest:Object.assign({},e.listRequest,{routeParameters:a})}),l=we(e,a);return l?(r(l),Object.assign({},s,{navigating:!0})):s})(e,t.sort,T);case"setAttractionsDates":return Me(e,t);case"setAttractionsListDates":return qe(Me(e,t),0,T);case"setAttractionsPax":return Object.assign({},e,{commerce:Object.assign({},e.commerce,{attractionCommerce:Object.assign({},null==(s=e.commerce)?void 0:s.attractionCommerce,{pax:t.pax})})});case"setHotelListTravelInfo":return((e,t,r)=>{var{newState:n,hasStateChanged:a}=Fe(e,t);return qe(n,0,r,a)})(e,{dates:t.dates,guests:t.guests},T);case"setHotelDetailTravelInfo":return((e,t,r)=>{var{newState:n,hasStateChanged:a}=Fe(e,t);return xe(n,r,a)})(e,{dates:t.dates,guests:t.guests},T);case"resetFilters":return((e,t)=>{var r,{listRequest:n,pageName:a}=e,s=[];e.pageName===Z&&0===((null==(r=s)?void 0:r.length)||0)&&(s=[N]);var l=Object.assign({},n.routeParameters,{filters:s,pagee:void 0}),i=Object.assign({},e,{listRequest:Object.assign({},e.listRequest,{routeParameters:l})});if(de(l,a),t){var u=we(e,l);if(u)return t(u),Object.assign({},i,{navigating:!0})}return i})(e,t.noNavigate?null:T);case"navigate":return T(t.route),e;default:return console.error("Unhandled action",t.type),e}};var Ge={screenType:"list",contentType:null,pageName:null,listRequest:{},detailRequest:{},commerce:null,sessionId:null,currentGeoPoint:null,tracking:null,updateToken:null,route:null,navigating:!0},Ue=()=>s.useContext(F),He=({children:e})=>{E();var[t,r]=function(){var e=s.useContext(p),t=s.useContext(h),r=s.useContext(T),l=function(){var[{page:e}]=s.useContext(p);return x.list.includes(e)?"list":x.detail.includes(e)?"detail":(console.error("Unknown mapping for",e,"assuming 'list'"),"list")}(),[i,{navigate:u}]=e,o=Ie(),c=function(){var e=s.useContext(h),t=s.useContext(p),[r]=t,n=Ie(),{clearDatesOnGeoChange:a}=s.useContext(w),l=r.params.geoId||0;return s.useEffect((()=>{n!==z&&n!==W||!a||((e,t)=>{var r="FUSION_ATTRACTION_COMMERCE_DATE_GEO_ID",n=f.get(r);if(0!==t&&n!==t){f.set(r,t);var{update:{attractions:{setDates:a}}}=e;a(null,null)}})(e,l)}),[l,a,e,n]),s.useMemo((()=>n===J?{hotelCommerce:Ce(e)}:n===z||n===W?{attractionCommerce:ke(e)}:n===X?{restaurantCommerce:Pe(e)}:null),[n,e])}(),{page:d}=i,g=y()?"MILES":"KILOMETERS",{sessionId:v}=r,{preferences:{currency:m}}=t,R=Le(),O=function(){var[{params:e,page:t}]=s.useContext(p),r=Ie(),l=Le(),i=(()=>{var e,t,r=k(),[{params:n,page:a}]=s.useContext(p),l=null!=n.geoId?n.geoId:void 0,i=null!=n.contentId?parseInt(n.contentId,10):0,u=s.useMemo((()=>({query:q,variables:{contentId:i},pause:!r||a!==ae||null!=l&&l>0||0===i})),[r,a,l,i]),[{data:o,fetching:c,error:d}]=I(u);return null!=l&&l>0||c||d?l:null==o||null==(e=o.result)||null==(t=e[0])?void 0:t.geoId})();return s.useMemo((()=>{var s,u,o,c={tracking:l},d=!1;if(b(t)){var g,v=(e=>{var t,r,n=(r=null==(t=a("AppList"))?void 0:t.pageParameters.map((e=>e.apiName)),new Set(r||[])),s={};return Object.entries(e||{}).forEach((([e,t])=>{n.has(e)&&(s[e]=t)})),s})(e);d=((null==v||null==(g=v.filters)?void 0:g.length)||0)>0,o=Object.assign({geoId:i},v)}else{var{offset:m}=e;d=Object.keys(e).length>1;var{filters:f,pagee:p}=d?{pagee:m?String(m):"0",filters:[]}:{};o={contentType:r,filters:f,geoId:i,pagee:p}}return o=d?(e=>{var t=(e=>n.get((e=>oe("sort",e))(e))||null)(e);return t?Object.assign({},e,{sort:e.sort||t.sort,sortOrder:e.sort||t.sort}):e})(o):o,(e=>{var{routeParameters:t}=e;if(t){var r=(e=>n.get(ce(e))||[])(t),{filters:a}=t;if(r&&a)return Object.assign({},e,{routeParameters:Object.assign({},t,{filters:ve(r,a)})})}return e})(Object.assign({},c,{routeParameters:Object.assign({},o,{filters:[...(null==(s=o)?void 0:s.filters)||[],..."attraction"===r?Te(null==(u=o)?void 0:u.filters):[]]})}))}),[r,t,e,l,i])}(),E=function(){var e,[{params:t}]=s.useContext(p),r=Le(),n=Ie(),a=null;return t.contentId?a=t.contentId:t.detailId&&(a=String(t.detailId)),t.offset&&(e=String(t.offset).replace(/[^0-9]/g,"")),s.useMemo((()=>({tracking:r,routeParameters:{contentType:n,contentId:a,pagee:e}})),[r,n,a,e])}(),A=s.useMemo((()=>({screenType:l,contentType:o,pageName:d,commerce:c,listRequest:O,detailRequest:E,currency:m,unitLength:g,sessionId:v,tracking:R,currentGeoPoint:null,route:i,navigating:!1})),[l,o,d,c,O,E,m,g,v,R,null,i]),[S,C]=s.useState(A);s.useEffect((()=>{C((e=>$e(e,{type:"reinitialize",newState:A},(()=>{}))))}),[A]);var P=s.useCallback((e=>{C((t=>$e(t,e,u)))}),[u]);return s.useMemo((()=>[S,P]),[S,P])}(),l=s.useMemo((()=>({state:t,dispatch:r})),[t,r]);return s.createElement(F.Provider,{value:l},s.createElement(A,{includeWebSiteSchema:!0}),e,s.createElement(O,null))},Be=()=>{var{dispatch:e}=Ue();return t=>{e({type:"setFilter",filters:t})}};function Qe(){var{viewportCategory:e}=l(R);return i((()=>({value:e,mobile:"MOBILE"===e,tablet:"TABLET"===e,desktop:"DESKTOP"===e,tabletOrSmaller:"MOBILE"===e||"TABLET"===e,tabletOrLarger:"TABLET"===e||"DESKTOP"===e})),[e])}function Ve(e,t=!0){if(e){var r=!!e.networkError,n=e.graphQLErrors&&e.graphQLErrors.length>0,a={networkError:r,graphQLError:n,anyError:r||n,toString:()=>e?function(e){var{networkError:t,graphQLErrors:r}=e,n=new Map;if(t){var{name:a,message:s}=t;n.set(`${a}: ${s}`,1)}return r&&r.forEach((e=>{var t;if("string"==typeof e)t=`GraphQLError: ${e}`;else{var{name:r,message:a}=e;t=`${r}: ${a}`}var s=n.get(t);s?n.set(t,s+1):n.set(t,1)})),[...n.entries()].map((([e,t])=>`${e} (${t} times)`)).join("\n")}(e):null};return t&&a.anyError&&H("GRAPHQL_SSR_ERROR",1),a}return{networkError:!1,graphQLError:!1,anyError:!1}}function Ke(e,t,r){if(!e&&!t)return null;if(!e||0===e.length)return t;if(!t)return e;if(!r||0===r.length)return e;var n=[];e.filter(Boolean).forEach((e=>{var t={section:e,next:null},r={head:t,tail:t};n.push(r)}));var a,s,l=(a=e,s=new Map,null===a||a.filter(Boolean).forEach(((e,t)=>{var{clusterId:r}=e;if(null!==r){var n=s.get(r)||[];n.push(t),s.set(r,n)}})),s),i=new Map,u=n[n.length-1];t.filter(Boolean).forEach((e=>{var t={section:e,next:null},{clusterId:a}=e;if(null!==a)if(r.includes(a)){var s=l.get(a);if(s&&0!==s.length){var o=s.shift(),c={head:t,tail:t};n[o]=c,u=c,i.set(a,c)}else{var d=i.get(a);d?(d.tail.next=t,d.tail=t,u=d):(u.tail.next=t,u.tail=t)}}else e.clusterId;else e.stableDiffingType})),r.filter(Boolean).forEach((t=>{var r;null==(r=l.get(t))||r.forEach((t=>{var r;e&&t===e.length-1&&(null==(r=n[t].head)?void 0:r.next)?n[t].head=n[t].head.next:n[t].head=null}))}));var o=[];return n.forEach((e=>{for(var t=e.head;t;)o.push(t.section),t=t.next})),o}var Ye=1e3,ze=e=>Array.isArray(e)?e[0]:e;function We(e){var t,[r,n]=s.useState(null),a=s.useRef([]),{current:l}=a,[i,u]=s.useMemo((()=>{var{query:t,variables:n,pause:s}=e,{pollInterval:l,updateToken:i,lastQuery:u}=r||{},o=S(n,u),c=null==n?void 0:n.request;return c&&l&&l>0&&i&&o?(i.substr(-20),[{query:t,variables:Object.assign({},n,{request:Object.assign({},c,{updateToken:i})}),pause:s},!0]):(a.current=[],[e,!1])}),[e,r]),[o,c]=P(i,Oe),d=ze(null==o||null==(t=o.data)?void 0:t.Result);s.useEffect((()=>{var t,a;!1===(null==d||null==(t=d.status)?void 0:t.success)&&console.error("[useAPSQuery] query failure",null==d||null==(a=d.status)?void 0:a.message);var{pollingStatus:s=null}=(null==d?void 0:d.status)||{},{delayForNextPollInMillis:l=null,updateToken:i=null}=s||{},u=l||Ye;u&&u<Ye&&(u=Ye);var o,c={lastQuery:Object.assign({},e.variables),pollInterval:l,updateToken:i};return l&&l>0&&c&&!S(c,r)&&(o=setTimeout((()=>{n(c)}),u)),()=>{o&&clearTimeout(o)}}),[a,d,r,e,u]);var{pollingStatus:g=null}=(null==d?void 0:d.status)||{},v=!(null==g?void 0:g.updateToken);return s.useMemo((()=>{var{data:e,fetching:t,error:r}=o;if(u&&!t&&!r&&e){var n;a.current=Ke(a.current,null==(n=ze(e.Result))?void 0:n.sections)||[];var s=((e,t)=>(null==e?void 0:e.Result)&&t?Array.isArray(e.Result)?Object.assign({},e,{Result:[Object.assign({},e.Result[0],{sections:t})]}):Object.assign({},e,{Result:Object.assign({},e.Result,{sections:t})}):e)(e,l);if(s)return[{data:Object.assign({},e,{},s),fetching:t,error:r,polling:u&&!v},c]}return[{data:e,fetching:t&&!u,polling:!v,error:r},c]}),[l,u,v,o,c])}var Je="[Fusion/APSUnexpected]",Xe={INFO:{alertLevel:"primary",log:e=>{}},WARNING:{alertLevel:"warning",log:e=>console.warn(Je,e)},ERROR:{alertLevel:"danger",log:e=>console.error(Je,e)}},Ze=({message:e,level:t="ERROR"})=>{var r=k(),n=Xe[t]||Xe.ERROR;return u((()=>{var a=`${t}~${e}`;r&&e&&!M.has(a)&&n.log(e),M.add(a)}),[t,e,n,r]),null},et=({queryName:e,urqlError:t,apsStatus:r,emptyResponse:n,fetching:a,children:l})=>{var i,u,o,c=!1,d="retry",g=n&&!a;if(g||t){var v=g?" is empty":"",m=!!(null==t?void 0:t.networkError)||!1,f=t?` with error: ${i=t,o=[],(null==i||null==(u=i.networkError)?void 0:u.message)&&o.push("network error"),(null==i?void 0:i.graphQLErrors.length)>0&&o.push(`[GraphQL] ${i.graphQLErrors[0].message.replace(/Error #[0-9]+/g,"Error #xxx")}${i.graphQLErrors.length>1?"...":""}`),o.join(" ")}`:"";console.error(`[Fusion] GraphQL error for ${e}`,`GraphQL response${v}${f}`),c=g,d=m?"sync-error":"retry"}if(!a){if(!1===(null==r?void 0:r.success)){var p=(null==r?void 0:r.message)?` with message: ${null==r?void 0:r.message}`:"";console.error(`[Fusion] APS error for ${e}`,p)}null==r||r.partial}return c?s.createElement("div",null,s.createElement(C,null,s.createElement(_,{variant:d})),l):l},tt=e=>null==e,rt=e=>{if(tt(e))throw new Error(`[Fusion] Unexpected null/undefined filter value: ${String(e)}`);var t=Number(e);if(isNaN(t))throw new Error(`[Fusion] Bad number value: ${String(e)}`);return t};function nt(e){var t=[];return tt(e)||null==e||e.forEach((e=>{null!=e&&t.push(e)})),t}var at=({typename:e})=>s.createElement(Ze,{message:`Unsupported type: ${String(e)}`});function st(e,t){return S(e,t)}function lt(e){return s.memo(e,st)}var it={nullCheck:"none",trackVisible:!0,memoize:!1};function ut(e,t){var r,{trackVisible:n,nullCheck:a="error",extraContext:l,whenNull:i,memoize:u}=Object.assign({},it,{},t),o=u?lt(e):e,c=function(e){var{model:t}=e;if(null==t&&"none"!==a){try{console[a]("[Fusion/NullCheck] unexpected null model")}catch(e){console.error("[Fusion]",e)}if(i)return i()}var r,{trackingKey:u,trackingTitle:c}=(null==(r=e.model)?void 0:r.trackingKey)?{trackingKey:r.trackingKey,trackingTitle:r.trackingTitle}:{trackingKey:null,trackingTitle:null},d=s.createElement(o,e);return g(u)?s.createElement(v,{trackingKey:u,trackingTitle:c||"DEFAULT",context:l,noVisibility:!1===n},d):d};return c.displayName=`Fused(${r=e,r.displayName||r.name||"Component"})`,c}function ot(e,t=!0,r){return ut(e,{trackVisible:t,extraContext:r,memoize:!0})}function ct(e,t=!0,r){return ot(e,t,r)}function dt(e,t){var r=()=>s.createElement("div",null,t&&t.map(((t,r)=>s.createElement("div",{key:r},s.createElement(e,{model:t}),s.createElement("hr",null)))));return r.displayName="APSStory",r}return e({APSStory:dt,FusionComponent:ct,apsMemo:lt,fuse:ot,fused:ut,hasFilters:Re,logFusionSsrMetric:H,mergeSections:Ke,removeNulls:nt,useAPSQuery:We,useAnalyzeError:Ve,useContentType:Ie,useScreenName:Ne,useViewportCategory:Qe}),[()=>{N={id:V,value:["true"]},L=new Set([V,K]),j=new Set(["B","BR","I","U","S","EM","STRONG","SPAN"]),D=s.memo(ye),w=s.createContext({clearDatesOnGeoChange:!1}),(q=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"BlenderGeoIdQuery"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"contentId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"Int"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","alias":{"kind":"Name","value":"result"},"name":{"kind":"Name","value":"SeoMetaData_getBlenderData"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"request"},"value":{"kind":"ListValue","values":[{"kind":"Variable","name":{"kind":"Name","value":"contentId"}}]}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"geoId"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":130}}')).__key=32025661472868,x={list:["Hotels",ne,"HotelsList",ae,"HotelsNear","Attractions",Z,"Attraction_Products",te,"Restaurants",le],detail:["Hotel_Review",se,"Restaurant_Review",ie,"Attraction_Review",ee,"AttractionProductReview",re]},F=s.createContext({state:Ge,dispatch:()=>{}}),M=new Set,$=s.createContext({loading:!1,polling:!1}),G=s.createContext({donePolling:!1}),e({ALL_ATTRACTIONS_CATEGORY_FILTER_VALUE:"ALL",APSStory:dt,APSUnexpected:Ze,APSUnsupportedType:at,ATTRACTIONS_CATEGORY_DAY_TRIPS:"63",CONTENT_TYPE_ATTRACTION:z,CONTENT_TYPE_ATTRACTION_PRODUCT:W,CONTENT_TYPE_HOTEL:J,CONTENT_TYPE_RESTAURANT:X,CheckAPSQueryResponse:et,CommerceInputsContextProvider:_e,Entrypoint:He,FILTER_ATTRACTIONS_ALL_ID:V,FILTER_ATTRACTIONS_CATEGORY_ID:Q,FILTER_ATTRACTIONS_L1_CATEGORY_ID:B,FILTER_ATTRACTIONS_SUPPLIER_TOGGLE_ID:K,FusionComponent:ct,FusionTrackedLink:Ae,HtmlString:D,ISODateString:pe,ISOTimeString:he,LoadingContext:$,PAGE_ATTRACTION_DETAIL:ee,PAGE_ATTRACTION_LIST:Z,PAGE_ATTRACTION_PRODUCT_DETAIL:re,PAGE_ATTRACTION_PRODUCT_LIST:te,PAGE_HOTELS:ne,PAGE_HOTELS_LIST:ae,PAGE_HOTEL_DETAIL:se,PAGE_RESTAURANT_DETAIL:ie,PAGE_RESTAURANT_LIST:le,PollingContext:G,REMOVE_FLAG:ue,applyFilterChangeList:me,apsMemo:lt,assignHotelChildrenToRooms:je,assignHotelGuestsToRooms:De,fuse:ot,fused:ut,getPageeOffsetValue:be,hasFilters:Re,isNullOrUndefined:tt,listResponseStatusCheck:Ee,logFusionSsrMetric:H,mergeFilterChangeLists:fe,mergeSections:Ke,removeNulls:nt,responseStatusCheck:Oe,stringToNumber:rt,unionFilters:ve,useAPSQuery:We,useAnalyzeError:Ve,useContentType:Ie,useEntrypointContext:Ue,useScreenName:Ne,useSetFilter:Be,useViewportCategory:Qe})},[e=>r=e.logSsrMetric,e=>n=e.default,e=>a=e.getPageDefForPage,e=>(s=e,l=e.useContext,i=e.useMemo,u=e.useEffect),e=>o=e.default,e=>c=e.useLinkTarget,t=>{d=t.useFusionTracking,g=t.isValidTrackingKey,v=t.FusionTracking,e({useConsoleLogImpressions:t.useConsoleLogImpressions,useTracking:t.useFusionTracking})},e=>m=e.useLocalize,e=>f=e.default,e=>(p=e.Route,h=e.TravelInfo,T=e.Visitor,R=e.Device),e=>O=e.default,e=>E=e.useBounceRateTracking,e=>A=e.OrganizationJsonLd,e=>S=e.default,e=>y=e.useIsMiles,e=>b=e.isFusionPage,e=>I=e.useQuery,e=>(k=e.useIsRobotSafe,C=e.MountedClientOnly),e=>P=e.useQueryRequiredSsr,e=>_=e.default]]},["B7vHz6","qKFflQ","F8raOV","cDcdfi","5KqyYa","mGAIj_","BfEQXK","0DsHEV","jaCyxS","2R4xv2","P5nZ8I","mxARhC","nPqO2d","YwNsO_","-qDq4b","DY6uxn","5X2em-","4Z07E2","OnmvvE","jhfxP-"]]);

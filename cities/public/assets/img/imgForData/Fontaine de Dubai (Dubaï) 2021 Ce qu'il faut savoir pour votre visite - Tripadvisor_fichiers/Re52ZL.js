(this.$WP=this.$WP||[]).push(["Re52ZL",(e,t)=>{"use strict";var a,n,i,l,r,o,s,u,d,c,m,p,v,g,h,k,C,S,b,E,_,f,y,A,N,I,T,F,D,P,O,M,L,w,R,B,V,x,G,H,q,K,z,U,W,Y,$,j,J,X,Z,Q,ee,te,ae,ne,ie,le,re=()=>{var e,{userAgentCategory:t}=n(h),{preferences:{currency:a}}=n(k),[,r]=te(le),[o,s]=i({}),[u,d]=i(null),[c,m]=i(!0);l((()=>d(window.location.origin)),[]);var p=(e=>{switch(e){case"TABLET":return"TabletWeb";case"MOBILE":return"MobileWeb";default:return"Desktop"}})(t);return l((()=>{u&&r({request:{clientType:p,currencyCode:a,origin:u}}).then((e=>{var t;s(null==(t=e.data)?void 0:t.subscriptionCheckout),m(!1)})).catch()}),[a,r,u,p]),{billingAccountId:null==o?void 0:o.billingAccountId,loadingCheckoutSession:c,cdeSession:null==o?void 0:o.cdeSession,paymentCountries:null==o||null==(e=o.countryStateData)?void 0:e.availableCountries.filter(Boolean).map((e=>function(e){var{countryName:t,isoCode:a,statesData:n}=e;return{alphaCode:a||"",name:t||"",countryCode:void 0,geoId:void 0,states:n?n.filter(Boolean).map((e=>function(e){var{isoCode:t,stateName:a}=e;return{code:t||"",name:a||""}}(e))).sort(((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()))):[]}}(e)))}},oe=({isModal:e})=>{var t=Z(),n=()=>a.createElement(Q,{variant:"primary",onClick:()=>t(V("/OptimusAccountManager"))},a.createElement(W,{id:"plus_confirmation_manage_membership_cta"}));return e?a.createElement(a.Fragment,null,a.createElement(ne,{variant:"title-01",marginY:"spacing-05"},a.createElement(Y,{id:"plus_already_member"})),a.createElement(n,null)):a.createElement(ae,{title:a.createElement(Y,{id:"plus_already_member"})},a.createElement(N,{paddingY:"spacing-03",paddingX:["spacing-04","spacing-04","spacing-00"]},a.createElement(n,null)))},se=()=>a.createElement(N,{className:"_1znzu37E",display:"flex",justifyContent:"center",alignItems:"center"},a.createElement(ie,{size:"large",variant:"primary"})),ue="STANDALONE",de=({mode:e,modalVariant:t,onPaymentError:h,onPurchaseSuccess:k,hotelId:_,freeTrialSubscription:T=!1,children:F})=>{var D,G,Q,te,[,{uid:ae}]=n(C),{funnelKey:ne}=n(f),ie=Z(),le=J(),de=X(),ce=q(),{localize:me}=$(),pe=j(),ve=a.useCallback((e=>pe.formatDate("date_short_year_long",e)),[pe]),ge=u("plus_discount_codes"),[he,ke]=i(null),{subscriptionPrice:Ce,fetching:Se,error:be}=K(T),{fullSubscription:Ee,discount:_e,trialPeriod:fe}=Ce||{},{firstCharge:ye}=Ee||{},[{data:Ae}]=z(),Ne=U(),[Ie,Te]=i(!1),[Fe,De]=i(!1),[Pe,Oe]=i(0),Me=r(null),[,Le]=i(!1),[we,Re]=i(""),Be=d();l((()=>{Ie||Be((e=>{var t=e||null;t&&!Ie&&Re(t)}),null,(()=>Le(!0)))}),[Be,Ie]);var{billingAccountId:Ve,cdeSession:xe,paymentCountries:Ge,loadingCheckoutSession:He}=re(),{vaultDomain:qe,checkoutSessionId:Ke}=xe||{},{state:{email:{value:ze},phoneNumber:{value:Ue},firstName:{value:We},lastName:{value:Ye}},validate:$e}=n(H),{cdeIframeForm:{submit:je,isValid:Je,highlightErrors:Xe},paymentFormFields:{cardholderName:{value:Ze},street:{value:Qe},street2:{value:et},city:{value:tt},state:{value:at},country:{value:nt},postalCode:{value:it}},paymentMethodInfo:{paymentDetails:{storedCardId:lt}},promoCodeForm:rt,updatePromoCodeForm:ot,validateFormFields:st}=n(P),[ut,dt]=i(!1);l((()=>{var e=m.get("discountCode");ge&&!ut&&e&&rt.appliedPromoCode!==e&&(dt(!0),ot({displayState:"ShowPromoCodes",isApplying:!0,promoCodeField:Object.assign({},rt.promoCodeField,{value:e})}))}),[ve,me,rt,ut,dt,ge,ot]);var ct=null;if(R.includes(null==_e?void 0:_e.discountCode)?ct="Hertz":(null==_e?void 0:_e.discountCode)===B&&(ct="Rent the Runway"),null!=ct&&!he){var mt=new Date((new Date).setFullYear((new Date).getFullYear()+1));ke(a.createElement(Y,{id:"optimus_payment_alert_auto_renewal",args:{price:"$99",0:"_1Jv51kNH",date:ve(mt)}}))}var pt=S(_e||null,ct),vt=0===(null==ye?void 0:ye.totalAmount)&&0===(null==_e?void 0:_e.discountedPrice)&&(null==_e?void 0:_e.originalPrice)>0,gt=!!fe,ht=null==fe?void 0:fe.endDate;ht&&!he&&ke(a.createElement(W,{id:"plus_trial_payment_alert_v2",args:{endDate:ve(ht)}}));var kt=vt&&"EMPLOYEE_DISCOUNT"!==(null==_e?void 0:_e.discountType),Ct=lt||null,[St]=y(),[bt]=A(),Et=o((()=>St.filter((e=>e.valid&&!e.storedCardInfo.expired)).map((e=>e.storedCardInfo))),[St]),[_t,ft]=i(null),[yt,At]=i(!1),[Nt,It]=i(null),Tt=s((t=>{le({optimusCheckoutStep:{flow:gt?"STANDALONE_TRIAL":ue,funnelKey:ne,pageviewUid:ae,step:t,checkoutType:e}})}),[gt,le,ne,ae,e]),Ft=s((t=>{le({optimusCheckoutPurchaseError:{funnelKey:ne,pageviewUid:ae,flow:ue,type:t,checkoutType:e}})}),[ne,le,e,ae]),Dt=s((()=>!gt||"00000"!==it||(ft("FIELD_COMBINATION_ERROR"),It(me.string("zip_code_not_allowed_for_trial")),Te(!1),At(!1),!1)),[gt,it,It,Te,At,ft,me]),Pt=s((()=>{if(kt)return $e();var e=st(),t=$e(),a=Dt();return e&&t&&Je&&a}),[Je,st,$e,kt,Dt]),Ot=s((e=>{Te(!1),p.set("plus_confirm_px",!0);var t={currency:e.currency,totalAmount:e.totalAmount,subscriptionNumber:e.subscriptionNumber},a=k;if(!a){var n="";n+=_?`/Hotel_Review-d${_}?newPlusSubscriber=true&referringFunnelKey=${ne}`:ct?`/OptimusSubscriptionConfirmation?oik=${ne}&partnerFlow=${ct}`:`/OptimusSubscriptionConfirmation?oik=${ne}`,a=()=>ie(V(n))}ce(t).finally(a)}),[_,ne,ce,ie,k,ct]),Mt=s((()=>{(null==Me?void 0:Me.current)&&Me.current.scrollIntoView({behavior:"smooth",block:"start",inline:"start"})}),[Me]),Lt=s((e=>{Te(!1),At(!1),ft(e||"MISSING_DATA"),h(Ct)}),[h,Ct]),wt=s((()=>{Te(!1),At(!1),ft("INTERNAL_ERROR"),h(Ct)}),[h,Ct]),[Rt,Bt]=i(!1),[Vt,xt]=i(!1),Gt=s((()=>{!Rt&&u("plus_hotel_checkout_save_pii")&&(Bt(!0),xt(!0))}),[Rt]),Ht=a.useCallback(((e,t)=>{xt(t)}),[]),qt=s((e=>{var t,a=(null==_e?void 0:_e.discountCode)||null;if(t=(null==_e?void 0:_e.trialDiscount)&&fe&&fe.trialCharge?fe.trialCharge.totalAmount:void 0===(null==ye?void 0:ye.totalAmount)?null:null==ye?void 0:ye.totalAmount,e){var{token:n,cardType:i}=e;Ne({billingAccountId:Ve||"",source:"StandaloneCheckoutFlow",checkoutSessionId:Ke||"",billingAddress:{cardholderName:Ze,street:Qe,street2:et,country:nt,city:tt,state:at,postalCode:it},firstName:We,lastName:Ye,emailAddress:ze,phoneNumber:Ue,paymentToken:n,storedCardId:Ct,discountCode:a,onSuccess:Ot,onError:Lt,cardType:i,inAuthTransactionId:we,updateMemberAccountInfo:Vt,expectedSubscriptionPrice:t})}else Ne({billingAccountId:Ve||"",source:"StandaloneCheckoutFlow",checkoutSessionId:Ke||"",firstName:We,lastName:Ye,emailAddress:ze,phoneNumber:Ue,paymentToken:null,cardType:"",storedCardId:null,discountCode:a,onSuccess:Ot,onError:Lt,inAuthTransactionId:we,updateMemberAccountInfo:Vt,expectedSubscriptionPrice:t})}),[Ne,Ve,Ke,Ze,Qe,et,nt,tt,at,it,ze,Ue,We,Ye,Ct,null==_e?void 0:_e.discountCode,null==ye?void 0:ye.totalAmount,Ot,Lt,we,Vt,null==_e?void 0:_e.trialDiscount,fe]),Kt=s((({token:e,cardType:t})=>{At(!0),qt({token:e,cardType:t})}),[qt]),zt=s((()=>{if(Oe(Pe+1),Pt&&je){De(!0),ft(null);var t=Pt();de({OptimusStandaloneCheckout:{checkoutCompleteClick:{funnelKey:ne,pageviewUid:ae,isFormValid:t,isTrial:gt,checkoutType:e}}}),kt?t?(Te(!0),At(!0),qt(null)):(Te(!1),Mt()):(Je||Ft("CDEPaymentFormInvalid"),t?(Te(!0),je({name:Ze,address:{street:Qe,street2:et,country:nt,city:tt,state:at,postalCode:it}})):(Te(!1),Xe(),Mt()))}}),[Pt,je,de,ne,ae,Ft,Ze,Qe,et,nt,tt,at,it,Je,Xe,Mt,Pe,kt,qt,gt,e]),{selectedCard:Ut,openStoredCardsModal:Wt,showStoredCardsModal:Yt,closeStoredCardsModal:$t,updateSelectedCard:jt}=O({storedCards:Et});l((()=>{_t&&Me&&Mt()}),[_t,Mt]);var Jt=s((()=>Tt("CHECKOUT")),[Tt]);if((null==Ae?void 0:Ae.isMember)&&"memberCenter"!==t)return a.createElement(oe,{isModal:"PAGE"!==e});if(Se||He)return"PAGE"===e?a.createElement(I,null):a.createElement(se,null);if(null==ye||!ye.totalAmount&&!vt||!qe||!Ke||!Ge||!Ve||be||_t&&"PAYMENT_FAILURE"!==_t&&"FIELD_COMBINATION_ERROR"!==_t)return a.createElement(b,{flow:ue,errors:_t?[_t]:["MISSING_DATA"],isModal:"PAGE"!==e});var Xt=ge?null==_e?void 0:_e.originalPrice:ye.totalAmount,Zt=gt&&pt?[[{title:me.string("plus_checkout_trial_membership_item"),price:null==fe||null==(D=fe.trialCharge)?void 0:D.totalAmount,variant:"TRIAL"}],[{title:me.string("plus_checkout_total"),price:null==fe||null==(G=fe.trialCharge)?void 0:G.totalAmount,variant:"TOTAL"}]]:[[{title:me.string("plus_checkout_plus_membership_item"),price:Xt,variant:"TOTAL"}]];!gt&&ge&&pt&&(Zt[0].push({automationTitle:"discountCharge",onRemove:pt.onRemove,price:pt.price,subtitle:pt.subtitle,title:pt.title,tooltipBody:pt.tooltipBody,tooltipTitle:pt.tooltipTitle,variant:pt.variant}),Zt.push([{title:me.string("plus_checkout_total"),price:ye.totalAmount,variant:"TOTAL"}]));var Qt,ea=a.createElement(x,{initialFirstName:null==bt?void 0:bt.firstName,initialLastName:null==bt?void 0:bt.lastName,initialEmail:null==bt?void 0:bt.email,initialPhoneNumber:null==bt||null==(Q=bt.phoneNumbers)||null==(te=Q[0])?void 0:te.digits,checkoutType:"STANDALONE",onChangeCallback:Gt,isModal:"PAGE"!==e}),ta=vt?me.string("plus_checkout_charge_schedule_disclaimer_plus_free_and_hotel"):null,aa=a.createElement(a.Fragment,null,a.createElement(M,{vaultDomain:qe,checkoutSessionId:Ke,onSuccess:Kt,onError:wt,storedCard:Ut,subHeading:ta,checkoutType:"STANDALONE",isModal:"PAGE"!==e,paymentAlert:he}),"PAGE"!==e&&Et.length?a.createElement(N,{display:"flex",flexDirection:"column",alignItems:"flex-start"},a.createElement(ee,{variant:"accent",onClick:Wt},a.createElement(W,{id:"plus_checkout_change_payment_method_cta"}))):null),na=a.createElement(L,{countries:Ge,checkoutType:"STANDALONE",withoutAddCheckbox:!0,onChangeCallback:Gt,isModal:"PAGE"!==e}),ia=kt?null:a.createElement(w,{storedCards:Et,vaultDomain:qe,checkoutSessionId:Ke,onSuccess:Kt,onError:wt,countries:Ge,subHeading:ta,checkoutType:"STANDALONE",withoutAddCheckbox:!0,onChangeCallback:Gt,selectedCard:Ut,openStoredCardsModal:Wt,showStoredCardsModal:Yt,closeStoredCardsModal:$t,updateSelectedCard:jt,paymentAlert:he}),la=a.createElement("div",{"data-automation":"updateMemberAccountInfo"},a.createElement(g,{value:"updateMemberAccountInfo",disabled:!Rt,checked:Vt,label:me.string("ib_update_account_info"),variant:"trail",onToggle:Ht}));return F({submitting:Ie,showTransition:yt,travelerDetailsForm:ea,billingAndPaymentForm:ia,billingForm:na,paymentForm:aa,storedCard:Ut,updateMemberAccountInfo:la,formErrors:(Qt=_t,"PAYMENT_FAILURE"===Qt?a.createElement(c,{onIsVisibleCallback:()=>Ft(Qt)},a.createElement(N,{marginBottom:"spacing-04"},a.createElement(v,{ref:Me,variant:"danger",label:a.createElement(W,{id:"plus_checkout_inline_error_heading"})},a.createElement(W,{id:"plus_checkout_inline_error_subheading"})))):"FIELD_COMBINATION_ERROR"===Qt?a.createElement(c,{onIsVisibleCallback:()=>Ft(Qt)},a.createElement(N,{marginBottom:"spacing-04"},a.createElement(v,{ref:Me,variant:"danger",label:a.createElement(W,{id:"plus_checkout_inline_error_heading"})},Nt))):a.createElement(E,{ref:Me,showCdeValidationErrorMessages:Fe&&!kt,submissionAttempts:Pe,flow:ue})),charges:Zt,trialDetails:fe,partnerDiscountFlow:ct,isFullyDiscounted:vt,isNoPaymentPurchase:kt,totalSubscriptionAmount:ye.totalAmount,onIsVisible:Jt,onSubscriptionStartClick:zt,showStoredCardsModal:Yt,updateSelectedCard:jt,storedCards:Et,selectedCard:Ut})},ce=({mode:e,modalVariant:t,hotelId:n,funnelKey:i,onPurchaseSuccess:l,freeTrialSubscription:r,children:o})=>a.createElement(_,{funnelKey:i},a.createElement(D,null,a.createElement(G,null,a.createElement(T,{shouldLogoutAfterPaymentFailures:!0,renderBeforeLogout:()=>a.createElement(I,null)},(({failedCardPayment:i})=>a.createElement(F,{renderNotSecure:()=>a.createElement(I,null),skip:u("optimus_bypass_secure_login")},(()=>a.createElement(de,{mode:e,modalVariant:t,hotelId:n,onPaymentError:i,onPurchaseSuccess:l,freeTrialSubscription:r},o))))))));return[()=>{(le=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"StartCheckoutSessionMutation"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"request"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"OptimusBenefits_SubscriptionCheckoutSessionRequestInput"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","alias":{"kind":"Name","value":"subscriptionCheckout"},"name":{"kind":"Name","value":"OptimusBenefits_startSubscriptionCheckout"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"request"},"value":{"kind":"Variable","name":{"kind":"Name","value":"request"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"billingAccountId"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"cdeSession"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"checkoutSessionId"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"vaultDomain"},"arguments":[],"directives":[]}]}},{"kind":"Field","name":{"kind":"Name","value":"countryStateData"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"availableCountries"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"countryName"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"isoCode"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"statesData"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"isoCode"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"stateName"},"arguments":[],"directives":[]}]}}]}}]}}]}}]}}],"loc":{"start":0,"end":468}}')).__key=0xd94736f63dd6,e({ExistingMemberPage:oe,SubscriptionCheckoutModalLoading:se,SubscriptionCheckoutWrapper:ce,useSubscriptionCheckoutSession:re})},[e=>(a=e.default,n=e.useContext,i=e.useState,l=e.useEffect,r=e.useRef,o=e.useMemo,s=e.useCallback),e=>u=e.featureIsEnabled,e=>d=e.useInAuth,e=>c=e.IsVisibleOnce,e=>m=e.default,e=>p=e.default,e=>v=e.InlineAlert,e=>g=e.Checkbox,e=>(h=e.Device,k=e.TravelInfo,C=e.Route),e=>S=e.useDiscountCharge,e=>b=e.default,e=>E=e.default,e=>(_=e.FunnelTrackingProvider,f=e.FunnelTracking),e=>(y=e.useStoredCardsFlowState,A=e.useSensitiveFlowState),e=>N=e.Box,e=>I=e.default,e=>(T=e.OptimusHardGate,F=e.OptimusSecureLoginGate),e=>(D=e.PaymentProvider,P=e.Payment,O=e.useSelectedCard,M=e.PaymentDetailsForm,L=e.BillingAddressForm,w=e.BillingAndPaymentForm),e=>(R=e.HERTZ_DISCOUNTS,B=e.RTR_DISCOUNT),e=>V=e.needsRouting,e=>(x=e.default,G=e.TravelerDetailsProvider,H=e.TravelerDetails),e=>(q=e.useCommerceClickLogger,K=e.useOptimusSubscriptionPrice,z=e.useOptimusSubscription,U=e.usePurchaseOptimusSubscription),e=>(W=e.default,Y=e.UnsafeLocalize,$=e.useLocalize,j=e.useIntlFormatter),e=>J=e.useImpressionLogger,e=>X=e.useInteractionLogger,e=>Z=e.useNavigate,e=>(Q=e.default,ee=e.BorderlessButton),e=>te=e.useMutation,e=>ae=e.default,e=>ne=e.default,e=>ie=e.LoadingSpinner]]},["cDcdfi","-i3PJS","Rkbqrj","BLrxBS","jaCyxS","qKFflQ","AXLM-R","MsxLpS","2R4xv2","P89JOf","z3IoO6","9WVvjy","ETqDaL","rSObt2","SzaY02","a4qdZy","mT-Pb2","ENvJHX","7VHiHS","oPZBqR","uDwkMq","BWm3Dg","0DsHEV","30t50h","fsml46","1yEXVQ","7yGKf-","5X2em-","Kmjo-j","VP50Wc","V08PS7"]]);

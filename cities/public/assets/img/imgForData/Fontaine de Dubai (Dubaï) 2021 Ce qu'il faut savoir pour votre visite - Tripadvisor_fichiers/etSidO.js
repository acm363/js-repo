(this.$WP=this.$WP||[]).push(["etSidO",(e,t)=>{"use strict";var r,a,i,n,l,o,s,c,u,m,d,p,h,_,E,v,C,g,y,f,b,k,D,S,T,P,N,I,w,F,x,A,M,B="_3f8PDAO_",K=({variant:e})=>"SIGNUP"===e?r.createElement(d,{variant:"supporting-01"},r.createElement(h,{id:"checkout_modal_terms_and_conditions_sign_up",args:{href1:"https://tripadvisor.mediaroom.com/us-terms-of-use",href2:"https://tripadvisor.mediaroom.com/us-privacy-policy",href3:"https://tripadvisor.mediaroom.com/us-tripadvisor-plus-subscription-terms",className1:B,className2:B,className3:B}})):r.createElement(d,{variant:"supporting-01"},r.createElement(h,{id:"checkout_modal_terms_and_conditions",args:{href1:"https://tripadvisor.mediaroom.com/us-terms-of-use",href2:"https://tripadvisor.mediaroom.com/us-privacy-policy",href3:"https://tripadvisor.mediaroom.com/us-tripadvisor-plus-subscription-terms",className1:B,className2:B,className3:B}})),L=({productCard:e,children:t,onButtonClick:i,buttonText:n,isCommerceButton:l=!1,isButtonDisabled:o=!1,termsAndConditions:s})=>{var u="DESKTOP"===a(f).viewportCategory;return r.createElement(c,{display:"flex",flexDirection:"column",className:"lExCDcpb"},r.createElement(c,{display:"flex",flexDirection:["column","column","row"],alignItems:"flex-start",justifyContent:"flex-start",marginBottom:"spacing-04"},r.createElement(c,{className:"_2o01Hhls"},e),r.createElement(c,{className:"_3miUprRD"},t)),s&&r.createElement(c,{marginBottom:"spacing-04"},r.createElement(K,{variant:s})),r.createElement(c,{display:"flex",alignItems:"center",className:"no9jRtJ2"},r.createElement(k,{variant:l?"commerce":"primary",onClick:i,disabled:o,fullWidth:!u,size:"large"},r.createElement(c,{paddingX:"spacing-05"},n))))},V=({travelerDetailsForm:e,productCard:t,onContinueClick:i,onCompletePurchaseClick:n,isNoPaymentPurchase:l,submitting:o})=>{var{validate:s}=a(y);return r.createElement(L,{productCard:t,onButtonClick:l?()=>{s()&&n()}:()=>{s()&&i()},buttonText:l?r.createElement(p,{id:"checkout_modal_sign_up"}):r.createElement(p,{id:"checkout_modal_continue"}),isCommerceButton:!!l,isButtonDisabled:!!l&&o,termsAndConditions:l?"SIGNUP":void 0},e)},O=({paymentForm:e,productCard:t,onContinueClick:i,onCompletePurchaseClick:n,submitting:l,storedCard:o})=>{var{paymentFormFields:s,cdeIframeForm:c,updateFormField:u}=a(S),m=c.isValid&&s.cardholderName.isValid&&s.street.isValid&&s.street2.isValid&&s.city.isValid&&s.state.isValid&&s.country.isValid&&s.postalCode.isValid;return r.createElement(L,{productCard:t,onButtonClick:o?()=>{m?n():(u("cardholderName",{isDirty:!0}),u("street",{isDirty:!0}),u("street2",{isDirty:!0}),u("city",{isDirty:!0}),u("state",{isDirty:!0}),u("country",{isDirty:!0}),u("postalCode",{isDirty:!0}),c.highlightErrors())}:()=>{s.cardholderName.isValid&&c.isValid?i():(u("cardholderName",{isDirty:!0}),c.highlightErrors())},buttonText:o?r.createElement(p,{id:"checkout_modal_complete_purchase"}):r.createElement(p,{id:"checkout_modal_continue"}),isCommerceButton:!!o,isButtonDisabled:!!o&&l,termsAndConditions:o?"DEFAULT":void 0},e)},U=({billingForm:e,productCard:t,onCompletePurchaseClick:i,submitting:n})=>{var{paymentFormFields:l,updateFormField:o}=a(S),s=l.street.isValid&&l.street2.isValid&&l.city.isValid&&l.state.isValid&&l.country.isValid&&l.postalCode.isValid;return r.createElement(L,{productCard:t,buttonText:r.createElement(p,{id:"checkout_modal_complete_purchase"}),onButtonClick:()=>{s?i():(o("street",{isDirty:!0}),o("street2",{isDirty:!0}),o("city",{isDirty:!0}),o("state",{isDirty:!0}),o("country",{isDirty:!0}),o("postalCode",{isDirty:!0}))},isCommerceButton:!0,termsAndConditions:"DEFAULT",isButtonDisabled:n},e)},Y="_3xI_0cVY",R=({isFullyDiscounted:e,isNoPaymentPurchase:t,trialDetails:a,totalCharge:i,variant:n})=>{var l,o=_(),s=r.useCallback((e=>o.formatDate("date_short_year_long",e)),[o]),m="attractions"===n,E=new Date,C=((l=new Date).setFullYear(l.getFullYear()+1),l.setDate(l.getDate()-1),l),g=!!a,y="number"==typeof(null==i?void 0:i.price)?o.formatCurrency(null==i?void 0:i.price):null==i?void 0:i.price,f=((e,t,a,i,n)=>t?null:e?r.createElement(p,{id:"plus_checkout_free_membership_cancel_policy_v3"}):i&&(null==i?void 0:i.endDate)?a?r.createElement(d,{variant:"supporting-01"},r.createElement(h,{id:"plus_trial_membership_info_v2",args:{0:Y,1:"https://tripadvisor.mediaroom.com/us-tripadvisor-plus-subscription-terms"}})):r.createElement(p,{id:"plus_trial_membership_info",args:{date:n(null==i?void 0:i.endDate)}}):r.createElement(h,{id:"plus_checkout_membership_cancel_policy_v2",args:{href1:"https://tripadvisor.mediaroom.com/us-tripadvisor-plus-subscription-terms",className1:Y}}))(e,t,m,a,s);return r.createElement(c,{display:"flex",alignItems:"flex-start",flexDirection:"column",className:"_1bKGqGDI"},r.createElement(u,{below:"DESKTOP"},r.createElement(c,{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"spacing-03",className:"_1B0txYMf"},r.createElement(v,{variant:"plus-logo-short-white",width:80}))),r.createElement(c,{display:"flex",flexDirection:"row",justifyContent:"space-between",className:"_3bOZdDGJ"},r.createElement(d,{variant:"title-05"},(null==i?void 0:i.title)||""),y&&r.createElement(d,{variant:"title-05"},y)),m&&r.createElement(c,{paddingTop:"spacing-03"},r.createElement(d,{variant:"body-01"},r.createElement(p,{id:"plus_trial_product_marketing_info"}))),r.createElement(d,{variant:"body-01",marginTop:"spacing-03",color:"secondaryText"},((e,t)=>e?r.createElement(p,{id:"checkout_modal_free_year_membership"}):"MONTHS"===(null==t?void 0:t.trialPeriodUnits)?r.createElement(p,{id:"plus_checkout_trial_membership_v2",args:{numMonths:(null==t?void 0:t.trialPeriodDuration)||0}}):"DAYS"===(null==t?void 0:t.trialPeriodUnits)?r.createElement(p,{id:"plus_checkout_trial_membership_days",args:{numDays:(null==t?void 0:t.trialPeriodDuration)||0}}):r.createElement(p,{id:"plus_checkout_annual_membership",args:{0:1}}))(t,a)),r.createElement(c,null,r.createElement(d,{variant:"body-01",color:"secondaryText",marginTop:"spacing-02"},g&&(null==a?void 0:a.endDate)?r.createElement(p,{id:"plus_checkout_date_range",args:{start:s(E),end:s(null==a?void 0:a.endDate)}}):r.createElement(p,{id:"plus_checkout_date_range",args:{start:s(E),end:s(C)}})),f&&r.createElement(d,{variant:e?"title-05":"body-01",color:"secondaryText",marginTop:"spacing-02"},f)),r.createElement("div",{className:"_1LKVcaYT"},r.createElement(D,{href:"/Plus",target:"_blank"},r.createElement(p,{id:"checkout_modal_learn_more_link"}))))},H=()=>r.createElement("div",{className:"_1GLF2Cd1"}),G=({children:e})=>{var t="MOBILE"===a(f).viewportCategory;return r.createElement(c,{className:"_2aE4B8wS"},r.createElement(c,{className:w("D_AzIm54",{_1MBWaJ0U:t})},r.createElement(c,{className:"_1cMk3K8-"},e)))},W=({view:e,title:t,onSelect:i,index:n,submitting:l,activeIndex:o,showIcon:s})=>{var u=P(),[,{uid:m}]=a(b),{funnelKey:d}=a(T),p=()=>{switch(e){case"DETAILS":return"go_to_details";case"PAYMENT":return"go_to_payment";case"CHECKOUT":return"go_to_checkout";default:return"no_interaction"}};return r.createElement(c,{display:"inline-block",marginRight:"spacing-02",key:e,className:w(0===n?"_2Z_PldI9":"_3W4_18AN")},s&&r.createElement("span",{className:"_3vodGRvi"},r.createElement(N,{name:"single-chevron-right",color:"inherit",size:12})),r.createElement(I,{key:e,index:n+1,title:t,onSelect:()=>{u({OptimusCheckoutModal:{optimusCheckoutModalBreadcrumbClick:{funnelKey:d,pageviewUid:m,step:p(),checkoutType:"MODAL"}}}),i()},variant:"MODAL",isEnabled:o>=n&&!l,isActive:o===n}))},j={currentRoute:""},z=({children:e,currentRoute:t})=>r.createElement(A.Provider,{value:{currentRoute:t}},e),J=({children:e,route:t})=>{var{currentRoute:i}=a(A);return r.createElement("div",{className:F("cLYWhDKA",{EKnkloky:i!==t})},e)},q=({travelerDetailsForm:e,paymentForm:t,billingForm:a,isFullyDiscounted:i,isNoPaymentPurchase:s,trialDetails:_,charges:y,formErrors:f,onSubscriptionStartClick:b,onIsVisible:k,showTransition:D,submitting:S,storedCard:T,showStoredCardsModal:P,updateSelectedCard:N,storedCards:I,selectedCard:w,variant:F})=>{var{localize:x}=E(),[A,M]=m({view:"DETAILS"}),B=A.current.view,K=n((()=>{var e=[];return e.push({title:x.string("checkout_modal_details"),onSelect:()=>{M({view:"DETAILS"})},routerState:A,view:"DETAILS"}),e.push({title:x.string("checkout_modal_payment"),onSelect:()=>{M({view:"PAYMENT"})},routerState:A,view:"PAYMENT"}),T||e.push({title:x.string("checkout_modal_checkout"),onSelect:()=>{M({view:"CHECKOUT"})},routerState:A,view:"CHECKOUT"}),e.push({title:x.string("checkout_modal_booking_confirmation"),onSelect:()=>{},routerState:A,view:"CONFIRMATION"}),e}),[x,A,M,T]),L=n((()=>K.findIndex((({view:e})=>e===B))),[B,K]),Y=l((()=>{M({view:"PAYMENT"})}),[M]),j=l((()=>{M({view:"CHECKOUT"})}),[M]),q=l((()=>{b()}),[b]),X=y.flatMap((e=>e)).find((e=>"TRIAL"===e.variant)),Z=y.flatMap((e=>e)).find((e=>"TOTAL"===e.variant)),$=n((()=>{switch(F){case"testCreditCard":return r.createElement(d,{variant:"expressive-display-03"},r.createElement(p,{id:"plus_404_credit_card_sign_up"}));case"attractions":return r.createElement(d,{variant:"expressive-display-03"},r.createElement(h,{id:"plus_trial_checkout_modal_join_tripadvisor_plus_v2",args:{0:"_3CqMXMh7"}}));case"memberCenter":return r.createElement(d,{variant:"title-01"},r.createElement(p,{id:"plus_account_resubscribe_checkout_title"}));default:return r.createElement(d,{variant:"title-01"},r.createElement(p,{id:"checkout_modal_join_tripadvisor_plus"}))}}),[F]),Q=r.createElement(R,{isFullyDiscounted:i,isNoPaymentPurchase:s,trialDetails:_,totalCharge:X||Z,variant:F});return D?r.createElement(o,null):r.createElement(C,{onIsVisibleCallback:k},r.createElement(c,{className:"_1kyCgM8r"},!P&&r.createElement(r.Fragment,null,r.createElement(u,{above:"TABLET"},r.createElement(c,{marginBottom:"spacing-03"},r.createElement(v,{variant:"plus-logo-short",height:44}))),$,f,s?r.createElement(c,{marginTop:"spacing-04"}):r.createElement(r.Fragment,null,r.createElement(G,null,K.map(((e,t)=>r.createElement(W,{key:e.view,index:t,title:e.title,onSelect:e.onSelect,activeIndex:L,showIcon:!!K[t-1],submitting:S,view:e.view})))),r.createElement(u,{below:"DESKTOP"},r.createElement(H,null))),r.createElement(z,{currentRoute:A.current.view},r.createElement(J,{route:"DETAILS"},r.createElement(V,{travelerDetailsForm:e,productCard:Q,onContinueClick:Y,onCompletePurchaseClick:q,isNoPaymentPurchase:s,submitting:S})),r.createElement(J,{route:"PAYMENT"},r.createElement(O,{paymentForm:t,productCard:Q,onContinueClick:j,onCompletePurchaseClick:q,storedCard:T,submitting:S})),r.createElement(J,{route:"CHECKOUT"},r.createElement(U,{billingForm:a,productCard:Q,onCompletePurchaseClick:q,submitting:S})))),P&&I&&r.createElement(g,{onSelectionConfirm:N,storedCards:I,currentSelectedCard:w,mode:"PAGE"})))},X=({funnelKey:e,onPurchaseSuccess:t,variant:a,freeTrialSubscription:i,hotelId:n})=>r.createElement(s,{mode:"MODAL",modalVariant:a,funnelKey:e,onPurchaseSuccess:t,hotelId:n,freeTrialSubscription:i},(({formErrors:e,travelerDetailsForm:t,billingForm:i,paymentForm:n,onSubscriptionStartClick:l,onIsVisible:o,submitting:s,showTransition:c,isFullyDiscounted:u,isNoPaymentPurchase:m,charges:d,trialDetails:p,storedCard:h,showStoredCardsModal:_,updateSelectedCard:E,storedCards:v,selectedCard:C})=>r.createElement(q,{submitting:s,showTransition:c,travelerDetailsForm:t,billingForm:i,paymentForm:n,storedCard:h,formErrors:e,charges:d,trialDetails:p,isFullyDiscounted:u,isNoPaymentPurchase:m,onIsVisible:o,onSubscriptionStartClick:l,showStoredCardsModal:_,updateSelectedCard:E,storedCards:v,selectedCard:C,variant:a}))),Z=({funnelKey:e,onPurchaseSuccess:t,variant:a,hotelId:i,freeTrialSubscription:n})=>r.createElement(X,{funnelKey:e,onPurchaseSuccess:t,variant:a,hotelId:i,freeTrialSubscription:n}),$=({funnelKey:e,onPurchaseSuccess:t,backgroundColor:a="overlay",variant:i,hotelId:n,freeTrialSubscription:l})=>({content:r.createElement(Z,{funnelKey:e,onPurchaseSuccess:t,variant:i,hotelId:n,freeTrialSubscription:l}),accent:null,backgroundColor:a}),Q=({funnelKey:e,onClose:t,hotelId:a,variant:i})=>r.createElement(x,{variant:i,funnelKey:e,closeModal:t,hotelId:a}),ee=({funnelKey:e,onClose:t,backgroundColor:a="overlay",hotelId:i,variant:n})=>({content:r.createElement(Q,{hotelId:i,variant:n,funnelKey:e,onClose:t}),accent:null,backgroundColor:a});return[()=>{A=i(j),M=i({isModalCheckout:!1}),e({ModalCheckoutContext:M,useCheckoutStepConfig:$,useConfirmationStepConfig:ee})},[e=>(r=e.default,a=e.useContext,i=e.createContext,n=e.useMemo,l=e.useCallback),e=>(o=e.SubscriptionCheckoutModalLoading,s=e.SubscriptionCheckoutWrapper),e=>(c=e.Box,u=e.Hidden),e=>m=e.default,e=>d=e.default,e=>(p=e.default,h=e.UnsafeLocalize,_=e.useIntlFormatter,E=e.useLocalize),e=>v=e.default,e=>C=e.IsVisibleOnce,e=>g=e.default,e=>y=e.TravelerDetails,e=>(f=e.Device,b=e.Route),e=>(k=e.default,D=e.BorderlessButtonLink),e=>S=e.Payment,e=>T=e.FunnelTracking,e=>P=e.useInteractionLogger,e=>N=e.default,e=>I=e.default,e=>w=e.default,e=>F=e.default,e=>x=e.SubscriptionConfirmation]]},["cDcdfi","Re52ZL","SzaY02","eDoFHZ","VP50Wc","0DsHEV","TkeYrn","BLrxBS","cpBgJU","uDwkMq","2R4xv2","7yGKf-","ENvJHX","ETqDaL","fsml46","pyY-iJ","ck96Hk","iekllc","jSLlaY","Ag9Xrp"]]);
